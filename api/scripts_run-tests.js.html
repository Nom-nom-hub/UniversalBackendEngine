<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>scripts/run-tests.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AIServiceManager.html">AIServiceManager</a><ul class='methods'><li data-type='method'><a href="AIServiceManager.html#classifyText">classifyText</a></li><li data-type='method'><a href="AIServiceManager.html#generateEmbeddings">generateEmbeddings</a></li><li data-type='method'><a href="AIServiceManager.html#generateText">generateText</a></li><li data-type='method'><a href="AIServiceManager.html#getService">getService</a></li><li data-type='method'><a href="AIServiceManager.html#initialize">initialize</a></li><li data-type='method'><a href="AIServiceManager.html#initializeService">initializeService</a></li><li data-type='method'><a href="AIServiceManager.html#processImage">processImage</a></li></ul></li><li><a href="AdminInterfaceGenerator.html">AdminInterfaceGenerator</a><ul class='methods'><li data-type='method'><a href="AdminInterfaceGenerator.html#generateRoutes">generateRoutes</a></li><li data-type='method'><a href="AdminInterfaceGenerator.html#initialize">initialize</a></li><li data-type='method'><a href="AdminInterfaceGenerator.html#loadModels">loadModels</a></li><li data-type='method'><a href="AdminInterfaceGenerator.html#serveAdminUI">serveAdminUI</a></li><li data-type='method'><a href="AdminInterfaceGenerator.html#setupAuthentication">setupAuthentication</a></li></ul></li><li><a href="AuditManager.html">AuditManager</a><ul class='methods'><li data-type='method'><a href="AuditManager.html#createAuditContext">createAuditContext</a></li><li data-type='method'><a href="AuditManager.html#createAuditMiddleware">createAuditMiddleware</a></li><li data-type='method'><a href="AuditManager.html#createAuditTables">createAuditTables</a></li><li data-type='method'><a href="AuditManager.html#executeRightToBeForgotten">executeRightToBeForgotten</a></li><li data-type='method'><a href="AuditManager.html#generateGDPRExport">generateGDPRExport</a></li><li data-type='method'><a href="AuditManager.html#getAccessLogsForEntity">getAccessLogsForEntity</a></li><li data-type='method'><a href="AuditManager.html#getAuditLogsForEntity">getAuditLogsForEntity</a></li><li data-type='method'><a href="AuditManager.html#initialize">initialize</a></li><li data-type='method'><a href="AuditManager.html#logAccess">logAccess</a></li><li data-type='method'><a href="AuditManager.html#logChanges">logChanges</a></li><li data-type='method'><a href="AuditManager.html#sanitizeRequestBody">sanitizeRequestBody</a></li><li data-type='method'><a href="AuditManager.html#shouldAuditRequest">shouldAuditRequest</a></li></ul></li><li><a href="CacheManager.html">CacheManager</a><ul class='methods'><li data-type='method'><a href="CacheManager.html#clearNamespace">clearNamespace</a></li><li data-type='method'><a href="CacheManager.html#createMiddleware">createMiddleware</a></li><li data-type='method'><a href="CacheManager.html#delete">delete</a></li><li data-type='method'><a href="CacheManager.html#generateKey">generateKey</a></li><li data-type='method'><a href="CacheManager.html#get">get</a></li><li data-type='method'><a href="CacheManager.html#getOrSet">getOrSet</a></li><li data-type='method'><a href="CacheManager.html#set">set</a></li></ul></li><li><a href="EdgeComputingManager.html">EdgeComputingManager</a><ul class='methods'><li data-type='method'><a href="EdgeComputingManager.html#applyChangesFromEdge">applyChangesFromEdge</a></li><li data-type='method'><a href="EdgeComputingManager.html#applyCreateChange">applyCreateChange</a></li><li data-type='method'><a href="EdgeComputingManager.html#applyDeleteChange">applyDeleteChange</a></li><li data-type='method'><a href="EdgeComputingManager.html#applyUpdateChange">applyUpdateChange</a></li><li data-type='method'><a href="EdgeComputingManager.html#deployFunctionToEdge">deployFunctionToEdge</a></li><li data-type='method'><a href="EdgeComputingManager.html#executeFunctionOnEdge">executeFunctionOnEdge</a></li><li data-type='method'><a href="EdgeComputingManager.html#fetchPendingChanges">fetchPendingChanges</a></li><li data-type='method'><a href="EdgeComputingManager.html#getAllEdgeNodesStatus">getAllEdgeNodesStatus</a></li><li data-type='method'><a href="EdgeComputingManager.html#getEdgeNodeStatus">getEdgeNodeStatus</a></li><li data-type='method'><a href="EdgeComputingManager.html#getPendingChangesForNode">getPendingChangesForNode</a></li><li data-type='method'><a href="EdgeComputingManager.html#initialize">initialize</a></li><li data-type='method'><a href="EdgeComputingManager.html#loadEdgeNodes">loadEdgeNodes</a></li><li data-type='method'><a href="EdgeComputingManager.html#markChangeAsProcessed">markChangeAsProcessed</a></li><li data-type='method'><a href="EdgeComputingManager.html#pushChangesToEdge">pushChangesToEdge</a></li><li data-type='method'><a href="EdgeComputingManager.html#registerEdgeNode">registerEdgeNode</a></li><li data-type='method'><a href="EdgeComputingManager.html#signChange">signChange</a></li><li data-type='method'><a href="EdgeComputingManager.html#synchronizeAll">synchronizeAll</a></li><li data-type='method'><a href="EdgeComputingManager.html#synchronizeNode">synchronizeNode</a></li><li data-type='method'><a href="EdgeComputingManager.html#unregisterEdgeNode">unregisterEdgeNode</a></li><li data-type='method'><a href="EdgeComputingManager.html#validateChangeSignature">validateChangeSignature</a></li></ul></li><li><a href="EventManager.html">EventManager</a><ul class='methods'><li data-type='method'><a href="EventManager.html#getEvents">getEvents</a></li><li data-type='method'><a href="EventManager.html#initialize">initialize</a></li><li data-type='method'><a href="EventManager.html#initializeEventStore">initializeEventStore</a></li><li data-type='method'><a href="EventManager.html#initializeMessageQueue">initializeMessageQueue</a></li><li data-type='method'><a href="EventManager.html#publishEvent">publishEvent</a></li><li data-type='method'><a href="EventManager.html#replayEvents">replayEvents</a></li><li data-type='method'><a href="EventManager.html#setupMessageHandlers">setupMessageHandlers</a></li><li data-type='method'><a href="EventManager.html#subscribeToEvent">subscribeToEvent</a></li><li data-type='method'><a href="EventManager.html#unsubscribeFromEvent">unsubscribeFromEvent</a></li></ul></li><li><a href="I18nManager.html">I18nManager</a><ul class='methods'><li data-type='method'><a href="I18nManager.html#changeLanguage">changeLanguage</a></li><li data-type='method'><a href="I18nManager.html#createSampleLocales">createSampleLocales</a></li><li data-type='method'><a href="I18nManager.html#formatCurrency">formatCurrency</a></li><li data-type='method'><a href="I18nManager.html#formatDate">formatDate</a></li><li data-type='method'><a href="I18nManager.html#formatNumber">formatNumber</a></li><li data-type='method'><a href="I18nManager.html#getCurrentLanguage">getCurrentLanguage</a></li><li data-type='method'><a href="I18nManager.html#getMiddleware">getMiddleware</a></li><li data-type='method'><a href="I18nManager.html#getSupportedLanguages">getSupportedLanguages</a></li><li data-type='method'><a href="I18nManager.html#initialize">initialize</a></li><li data-type='method'><a href="I18nManager.html#translate">translate</a></li></ul></li><li><a href="MockDatabase.html">MockDatabase</a></li><li><a href="MockDatabaseClient.html">MockDatabaseClient</a></li><li><a href="MonitoringManager.html">MonitoringManager</a><ul class='methods'><li data-type='method'><a href="MonitoringManager.html#createMiddleware">createMiddleware</a></li><li data-type='method'><a href="MonitoringManager.html#getMetricsHandler">getMetricsHandler</a></li><li data-type='method'><a href="MonitoringManager.html#incrementCounter">incrementCounter</a></li><li data-type='method'><a href="MonitoringManager.html#initialize">initialize</a></li><li data-type='method'><a href="MonitoringManager.html#initializeDatadog">initializeDatadog</a></li><li data-type='method'><a href="MonitoringManager.html#initializeNewRelic">initializeNewRelic</a></li><li data-type='method'><a href="MonitoringManager.html#initializePrometheus">initializePrometheus</a></li><li data-type='method'><a href="MonitoringManager.html#initializeProvider">initializeProvider</a></li><li data-type='method'><a href="MonitoringManager.html#recordHistogram">recordHistogram</a></li><li data-type='method'><a href="MonitoringManager.html#recordMetric">recordMetric</a></li><li data-type='method'><a href="MonitoringManager.html#shutdown">shutdown</a></li><li data-type='method'><a href="MonitoringManager.html#startSystemMetricsCollection">startSystemMetricsCollection</a></li><li data-type='method'><a href="MonitoringManager.html#startTimer">startTimer</a></li></ul></li><li><a href="OpenAIService.html">OpenAIService</a><ul class='methods'><li data-type='method'><a href="OpenAIService.html#classifyText">classifyText</a></li><li data-type='method'><a href="OpenAIService.html#generateEmbeddings">generateEmbeddings</a></li><li data-type='method'><a href="OpenAIService.html#generateText">generateText</a></li><li data-type='method'><a href="OpenAIService.html#initialize">initialize</a></li><li data-type='method'><a href="OpenAIService.html#processImage">processImage</a></li></ul></li><li><a href="PluginManager.html">PluginManager</a><ul class='methods'><li data-type='method'><a href="PluginManager.html#createMiddleware">createMiddleware</a></li><li data-type='method'><a href="PluginManager.html#executeHooks">executeHooks</a></li><li data-type='method'><a href="PluginManager.html#loadPlugins">loadPlugins</a></li><li data-type='method'><a href="PluginManager.html#register">register</a></li></ul></li><li><a href="PostgresEventStore.html">PostgresEventStore</a><ul class='methods'><li data-type='method'><a href="PostgresEventStore.html#getEvents">getEvents</a></li><li data-type='method'><a href="PostgresEventStore.html#initialize">initialize</a></li><li data-type='method'><a href="PostgresEventStore.html#storeEvent">storeEvent</a></li></ul></li><li><a href="RedisQueue.html">RedisQueue</a><ul class='methods'><li data-type='method'><a href="RedisQueue.html#initialize">initialize</a></li><li data-type='method'><a href="RedisQueue.html#publish">publish</a></li><li data-type='method'><a href="RedisQueue.html#subscribe">subscribe</a></li><li data-type='method'><a href="RedisQueue.html#unsubscribe">unsubscribe</a></li></ul></li><li><a href="SecurityAuditManager.html">SecurityAuditManager</a><ul class='methods'><li data-type='method'><a href="SecurityAuditManager.html#createAuditTables">createAuditTables</a></li><li data-type='method'><a href="SecurityAuditManager.html#createMiddleware">createMiddleware</a></li><li data-type='method'><a href="SecurityAuditManager.html#getSecurityAuditLogs">getSecurityAuditLogs</a></li><li data-type='method'><a href="SecurityAuditManager.html#initialize">initialize</a></li><li data-type='method'><a href="SecurityAuditManager.html#logSecurityEvent">logSecurityEvent</a></li><li data-type='method'><a href="SecurityAuditManager.html#shutdown">shutdown</a></li></ul></li><li><a href="SecurityScanner.html">SecurityScanner</a><ul class='methods'><li data-type='method'><a href="SecurityScanner.html#countIssues">countIssues</a></li><li data-type='method'><a href="SecurityScanner.html#findSourceFiles">findSourceFiles</a></li><li data-type='method'><a href="SecurityScanner.html#generateRecommendations">generateRecommendations</a></li><li data-type='method'><a href="SecurityScanner.html#generateReport">generateReport</a></li><li data-type='method'><a href="SecurityScanner.html#getConfigFiles">getConfigFiles</a></li><li data-type='method'><a href="SecurityScanner.html#getJsFiles">getJsFiles</a></li><li data-type='method'><a href="SecurityScanner.html#getLineNumber">getLineNumber</a></li><li data-type='method'><a href="SecurityScanner.html#initialize">initialize</a></li><li data-type='method'><a href="SecurityScanner.html#runAllScans">runAllScans</a></li><li data-type='method'><a href="SecurityScanner.html#runScan">runScan</a></li><li data-type='method'><a href="SecurityScanner.html#saveReport">saveReport</a></li><li data-type='method'><a href="SecurityScanner.html#scanCode">scanCode</a></li><li data-type='method'><a href="SecurityScanner.html#scanCode">scanCode</a></li><li data-type='method'><a href="SecurityScanner.html#scanConfigurations">scanConfigurations</a></li><li data-type='method'><a href="SecurityScanner.html#scanDependencies">scanDependencies</a></li><li data-type='method'><a href="SecurityScanner.html#scanDependencies">scanDependencies</a></li><li data-type='method'><a href="SecurityScanner.html#scanEndpoints">scanEndpoints</a></li><li data-type='method'><a href="SecurityScanner.html#sendEmailNotification">sendEmailNotification</a></li><li data-type='method'><a href="SecurityScanner.html#sendNotifications">sendNotifications</a></li><li data-type='method'><a href="SecurityScanner.html#sendSlackNotification">sendSlackNotification</a></li><li data-type='method'><a href="SecurityScanner.html#shutdown">shutdown</a></li></ul></li><li></li><li><a href="ServerlessAdapter.html">ServerlessAdapter</a><ul class='methods'><li data-type='method'><a href="ServerlessAdapter.html#createAWSHandler">createAWSHandler</a></li><li data-type='method'><a href="ServerlessAdapter.html#createAzureHandler">createAzureHandler</a></li><li data-type='method'><a href="ServerlessAdapter.html#createGCPHandler">createGCPHandler</a></li><li data-type='method'><a href="ServerlessAdapter.html#initialize">initialize</a></li></ul></li><li><a href="TenantManager.html">TenantManager</a><ul class='methods'><li data-type='method'><a href="TenantManager.html#createTenant">createTenant</a></li><li data-type='method'><a href="TenantManager.html#deleteTenant">deleteTenant</a></li><li data-type='method'><a href="TenantManager.html#getTenant">getTenant</a></li><li data-type='method'><a href="TenantManager.html#getTenantByDomain">getTenantByDomain</a></li><li data-type='method'><a href="TenantManager.html#getTenantDatabaseName">getTenantDatabaseName</a></li><li data-type='method'><a href="TenantManager.html#getTenantSchemaName">getTenantSchemaName</a></li><li data-type='method'><a href="TenantManager.html#initialize">initialize</a></li><li data-type='method'><a href="TenantManager.html#loadTenants">loadTenants</a></li><li data-type='method'><a href="TenantManager.html#tenantMiddleware">tenantMiddleware</a></li><li data-type='method'><a href="TenantManager.html#updateTenant">updateTenant</a></li></ul></li><li><a href="ValidationManager.html">ValidationManager</a><ul class='methods'><li data-type='method'><a href="ValidationManager.html#addSchema">addSchema</a></li><li data-type='method'><a href="ValidationManager.html#createValidationMiddleware">createValidationMiddleware</a></li><li data-type='method'><a href="ValidationManager.html#getSchema">getSchema</a></li><li data-type='method'><a href="ValidationManager.html#getSchemaNames">getSchemaNames</a></li><li data-type='method'><a href="ValidationManager.html#validate">validate</a></li></ul></li><li><a href="WorkflowEngine.html">WorkflowEngine</a><ul class='methods'><li data-type='method'><a href="WorkflowEngine.html#cancelWorkflow">cancelWorkflow</a></li><li data-type='method'><a href="WorkflowEngine.html#completeWorkflow">completeWorkflow</a></li><li data-type='method'><a href="WorkflowEngine.html#evaluateCondition">evaluateCondition</a></li><li data-type='method'><a href="WorkflowEngine.html#executeActions">executeActions</a></li><li data-type='method'><a href="WorkflowEngine.html#executeStateActions">executeStateActions</a></li><li data-type='method'><a href="WorkflowEngine.html#executeTransition">executeTransition</a></li><li data-type='method'><a href="WorkflowEngine.html#getWorkflowInstance">getWorkflowInstance</a></li><li data-type='method'><a href="WorkflowEngine.html#getWorkflowInstancesForEntity">getWorkflowInstancesForEntity</a></li><li data-type='method'><a href="WorkflowEngine.html#handleWorkflowCancel">handleWorkflowCancel</a></li><li data-type='method'><a href="WorkflowEngine.html#handleWorkflowComplete">handleWorkflowComplete</a></li><li data-type='method'><a href="WorkflowEngine.html#handleWorkflowStart">handleWorkflowStart</a></li><li data-type='method'><a href="WorkflowEngine.html#handleWorkflowTransition">handleWorkflowTransition</a></li><li data-type='method'><a href="WorkflowEngine.html#initialize">initialize</a></li><li data-type='method'><a href="WorkflowEngine.html#loadWorkflows">loadWorkflows</a></li><li data-type='method'><a href="WorkflowEngine.html#mapDatabaseInstanceToObject">mapDatabaseInstanceToObject</a></li><li data-type='method'><a href="WorkflowEngine.html#saveWorkflowInstance">saveWorkflowInstance</a></li><li data-type='method'><a href="WorkflowEngine.html#setupEventListeners">setupEventListeners</a></li><li data-type='method'><a href="WorkflowEngine.html#startWorkflow">startWorkflow</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#$randomEmail">$randomEmail</a></li><li><a href="global.html#applyMiddleware">applyMiddleware</a></li><li><a href="global.html#calculatePercentile">calculatePercentile</a></li><li><a href="global.html#closeConnections">closeConnections</a></li><li><a href="global.html#closeDatabaseConnections">closeDatabaseConnections</a></li><li><a href="global.html#connectDatabases">connectDatabases</a></li><li><a href="global.html#connectMockDatabase">connectMockDatabase</a></li><li><a href="global.html#connectMongoDB">connectMongoDB</a></li><li><a href="global.html#connectPostgres">connectPostgres</a></li><li><a href="global.html#connectRedis">connectRedis</a></li><li><a href="global.html#createMigration">createMigration</a></li><li><a href="global.html#createMigrationsTable">createMigrationsTable</a></li><li><a href="global.html#deepMerge">deepMerge</a></li><li><a href="global.html#generateApiClient">generateApiClient</a></li><li><a href="global.html#generateGraphQLComposables">generateGraphQLComposables</a></li><li><a href="global.html#generateGraphQLHooks">generateGraphQLHooks</a></li><li><a href="global.html#generateIndexFile">generateIndexFile</a></li><li><a href="global.html#generateReactSDK">generateReactSDK</a></li><li><a href="global.html#generateRestComposables">generateRestComposables</a></li><li><a href="global.html#generateRestHooks">generateRestHooks</a></li><li><a href="global.html#generateVueSDK">generateVueSDK</a></li><li><a href="global.html#generateWebSocketComposables">generateWebSocketComposables</a></li><li><a href="global.html#generateWebSocketHooks">generateWebSocketHooks</a></li><li><a href="global.html#getAppliedMigrations">getAppliedMigrations</a></li><li><a href="global.html#getDatabaseClient">getDatabaseClient</a></li><li><a href="global.html#hasRoles">hasRoles</a></li><li><a href="global.html#isAuthenticated">isAuthenticated</a></li><li><a href="global.html#isObject">isObject</a></li><li><a href="global.html#loadConfig">loadConfig</a></li><li><a href="global.html#logger">logger</a></li><li><a href="global.html#mergeResolvers">mergeResolvers</a></li><li><a href="global.html#parseConfigValue">parseConfigValue</a></li><li><a href="global.html#recordMigration">recordMigration</a></li><li><a href="global.html#registerGRPCService">registerGRPCService</a></li><li><a href="global.html#registerModelEventHandlers">registerModelEventHandlers</a></li><li><a href="global.html#registerModelRoutes">registerModelRoutes</a></li><li><a href="global.html#runConcurrentTests">runConcurrentTests</a></li><li><a href="global.html#runMigrations">runMigrations</a></li><li><a href="global.html#runPerformanceTests">runPerformanceTests</a></li><li><a href="global.html#runTests">runTests</a></li><li><a href="global.html#selectRandomProduct">selectRandomProduct</a></li><li><a href="global.html#setNestedValue">setNestedValue</a></li><li><a href="global.html#setupApiKeyStrategy">setupApiKeyStrategy</a></li><li><a href="global.html#setupAuthRoutes">setupAuthRoutes</a></li><li><a href="global.html#setupAuthentication">setupAuthentication</a></li><li><a href="global.html#setupGRPC">setupGRPC</a></li><li><a href="global.html#setupGraphQLSchema">setupGraphQLSchema</a></li><li><a href="global.html#setupHealthChecks">setupHealthChecks</a></li><li><a href="global.html#setupJwtStrategy">setupJwtStrategy</a></li><li><a href="global.html#setupMonitoring">setupMonitoring</a></li><li><a href="global.html#setupMySQL">setupMySQL</a></li><li><a href="global.html#setupOAuth2Strategies">setupOAuth2Strategies</a></li><li><a href="global.html#setupRESTApi">setupRESTApi</a></li><li><a href="global.html#setupRateLimiting">setupRateLimiting</a></li><li><a href="global.html#setupWebSockets">setupWebSockets</a></li><li><a href="global.html#simpleTest">simpleTest</a></li><li><a href="global.html#tenantContextMiddleware">tenantContextMiddleware</a></li><li><a href="global.html#testAI">testAI</a></li><li><a href="global.html#testAIServices">testAIServices</a></li><li><a href="global.html#testAsyncFunction">testAsyncFunction</a></li><li><a href="global.html#testAudit">testAudit</a></li><li><a href="global.html#testCache">testCache</a></li><li><a href="global.html#testEdgeComputing">testEdgeComputing</a></li><li><a href="global.html#testEndpoint">testEndpoint</a></li><li><a href="global.html#testEventSystem">testEventSystem</a></li><li><a href="global.html#testEvents">testEvents</a></li><li><a href="global.html#testFeatures">testFeatures</a></li><li><a href="global.html#testI18n">testI18n</a></li><li><a href="global.html#testMultiTenant">testMultiTenant</a></li><li><a href="global.html#testSecurity">testSecurity</a></li><li><a href="global.html#testValidation">testValidation</a></li><li><a href="global.html#testWorkflow">testWorkflow</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">scripts/run-tests.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const logger = require('../core/utils/logger');
const { loadConfig } = require('../config');
const { connectDatabases } = require('../core/database');
const { SecurityAuditManager, SecurityScanner } = require('../core/security');
const TenantManager = require('../core/multi-tenant');
const eventManager = require('../core/events');
const aiServiceManager = require('../core/ai');
const ValidationManager = require('../core/validation');
const I18nManager = require('../core/i18n');
const WorkflowEngine = require('../core/workflow');
const AuditManager = require('../core/audit');
const EdgeComputingManager = require('../core/edge');
const CacheManager = require('../core/cache');
const fs = require('fs').promises;
const path = require('path');
const mockDb = require('../core/database/mock');

/**
 * Run comprehensive tests on the Universal Backend Engine
 */
async function runTests() {
  try {
    logger.info('üöÄ Starting Universal Backend Engine tests...');
    
    // Load configuration
    const config = loadConfig();
    logger.info('‚úÖ Configuration loaded successfully');
    
    // Make sure all database configs have mock enabled for tests
    if (config.databases) {
      Object.keys(config.databases).forEach((dbType) => {
        if (config.databases[dbType]) {
          config.databases[dbType].mock = true;
        }
      });
    }
    
    // Connect to databases
    logger.info('Connecting to databases...');
    const connections = await connectDatabases(config.databases);
    logger.info('‚úÖ Database connections established');
    
    // Test components
    await testSecurity(config, connections);
    await testMultiTenant(config, connections);
    await testEvents(config, connections);
    await testAI(config);
    await testValidation(config);
    await testI18n(config);
    await testWorkflow(config, connections);
    await testAudit(config, connections);
    await testEdgeComputing(config);
    await testCache(connections.redis, config);
    
    // Close database connections
    logger.info('Closing database connections...');
    await closeDatabaseConnections(connections);
    logger.info('‚úÖ Database connections closed');
    
    logger.info('üéâ All tests completed successfully!');
  } catch (error) {
    logger.error('‚ùå Tests failed:', error);
    process.exit(1);
  }
}

/**
 * Test security features
 */
async function testSecurity(config, connections) {
  logger.info('Testing security features...');
  
  // Create mock connections if needed
  if (!connections.postgres &amp;&amp; config.security.audit.database === 'postgres') {
    connections.postgres = await mockDb.connect({});
  }
  
  // Test security audit
  if (config.security &amp;&amp; config.security.audit &amp;&amp; config.security.audit.enabled) {
    const securityAuditManager = new SecurityAuditManager(
      { ...config.security.audit, database: 'mock' }, 
      { mock: await mockDb.connect({}) }
    );
    
    await securityAuditManager.initialize();
    
    // Log a test security event
    await securityAuditManager.logSecurityEvent({
      action: 'TEST',
      resourceType: 'SYSTEM',
      result: 'SUCCESS',
      details: { test: true },
      ipAddress: '127.0.0.1',
      userAgent: 'Test Script'
    });
    
    // Retrieve the logged event
    const logs = await securityAuditManager.getSecurityAuditLogs({ 
      action: 'TEST',
      limit: 1
    });
    
    if (logs.length === 0) {
      throw new Error('Security audit log not found');
    }
    
    logger.info('‚úÖ Security audit test passed');
  } else {
    logger.info('‚è© Security audit not enabled, skipping test');
  }
  
  // Test security scanner
  if (config.security &amp;&amp; config.security.scanner &amp;&amp; config.security.scanner.enabled) {
    const securityScanner = new SecurityScanner(config.security.scanner);
    await securityScanner.initialize();
    
    // Create a test file with a security vulnerability
    const testDir = path.join(process.cwd(), 'test-temp');
    await fs.mkdir(testDir, { recursive: true });
    const testFile = path.join(testDir, 'test-vulnerability.js');
    await fs.writeFile(testFile, `
      // This file contains a deliberate security vulnerability for testing
      function unsafeCode() {
        const userInput = req.query.input;
        eval(userInput); // Deliberate vulnerability
        return true;
      }
    `);
    
    // Run a scan
    const _report = await securityScanner.runScan();
    
    // Clean up test file
    await fs.unlink(testFile);
    await fs.rmdir(testDir);
    
    logger.info('‚úÖ Security scanner test passed');
  } else {
    logger.info('‚è© Security scanner not enabled, skipping test');
  }
  
  logger.info('‚úÖ Security features tests completed');
}

/**
 * Test multi-tenant features
 */
async function testMultiTenant(config, connections) {
  logger.info('Testing multi-tenant features...');
  
  if (config.multiTenant &amp;&amp; config.multiTenant.enabled) {
    const tenantManager = new TenantManager(config.multiTenant, connections);
    await tenantManager.initialize();
    
    // Create a test tenant
    const testTenant = {
      id: 'test-tenant',
      name: 'Test Tenant',
      domain: 'test.example.com',
      settings: {
        theme: 'light',
        features: {
          billing: true
        }
      }
    };
    
    await tenantManager.createTenant(testTenant);
    
    // Get the tenant
    const retrievedTenant = await tenantManager.getTenant(testTenant.id);
    
    if (!retrievedTenant || retrievedTenant.name !== testTenant.name) {
      throw new Error('Failed to retrieve created tenant');
    }
    
    // Delete the test tenant
    await tenantManager.deleteTenant(testTenant.id);
    
    logger.info('‚úÖ Multi-tenant test passed');
  } else {
    logger.info('‚è© Multi-tenant not enabled, skipping test');
  }
  
  logger.info('‚úÖ Multi-tenant features tests completed');
}

/**
 * Test event system
 */
async function testEvents(config, connections) {
  logger.info('Testing event system...');
  
  if (config.events &amp;&amp; config.events.enabled) {
    eventManager.config = config.events;
    eventManager.connections = connections;
    await eventManager.initialize();
    
    // Create a test event handler
    let eventReceived = false;
    const testHandler = () => {
      eventReceived = true;
    };
    
    // Subscribe to test event
    eventManager.subscribe('test.event', testHandler);
    
    // Publish test event
    await eventManager.publish('test.event', { test: true });
    
    // Wait for event to be processed
    await new Promise((resolve) => setTimeout(resolve, 100));
    
    if (!eventReceived) {
      throw new Error('Event was not received by handler');
    }
    
    // Unsubscribe
    eventManager.unsubscribe('test.event', testHandler);
    
    logger.info('‚úÖ Event system test passed');
  } else {
    logger.info('‚è© Event system not enabled, skipping test');
  }
  
  logger.info('‚úÖ Event system tests completed');
}

/**
 * Test AI services
 */
async function testAI(config) {
  logger.info('Testing AI services...');
  
  if (config.ai &amp;&amp; config.ai.enabled) {
    aiServiceManager.config = config.ai;
    await aiServiceManager.initialize();
    
    // Only test if we have an API key
    if (process.env.OPENAI_API_KEY) {
      try {
        // Test text generation
        const result = await aiServiceManager.generateText({
          prompt: 'Write a short greeting',
          maxTokens: 20
        });
        
        if (!result || !result.text) {
          throw new Error('Failed to generate text');
        }
        
        logger.info('‚úÖ AI services test passed');
      } catch (error) {
        logger.warn(`‚ö†Ô∏è AI services test skipped: ${error.message}`);
      }
    } else {
      logger.info('‚è© OpenAI API key not found, skipping AI test');
    }
  } else {
    logger.info('‚è© AI services not enabled, skipping test');
  }
  
  logger.info('‚úÖ AI services tests completed');
}

/**
 * Test validation
 */
async function testValidation(config) {
  logger.info('Testing validation...');
  
  if (config.validation &amp;&amp; config.validation.enabled) {
    // Create validation manager
    const validationManager = new ValidationManager(config.validation);
    
    // Add a test schema
    const userSchema = {
      type: 'object',
      properties: {
        id: { type: 'integer' },
        name: { type: 'string', minLength: 2 },
        email: { type: 'string', format: 'email' },
        zipCode: { type: 'string', format: 'zipCode' }
      },
      required: ['name', 'email']
    };
    
    validationManager.addSchema('user', userSchema);
    
    // Test valid data
    const validUser = {
      id: 1,
      name: 'John Doe',
      email: 'john@example.com',
      zipCode: '12345'
    };
    
    const validResult = validationManager.validate('user', validUser);
    
    if (!validResult.valid) {
      throw new Error(`Validation failed for valid data: ${JSON.stringify(validResult.errors)}`);
    }
    
    // Test invalid data
    const invalidUser = {
      id: 'not-a-number',
      name: 'J',
      email: 'not-an-email',
      zipCode: 'invalid'
    };
    
    const invalidResult = validationManager.validate('user', invalidUser);
    
    if (invalidResult.valid) {
      throw new Error('Validation passed for invalid data');
    }
    
    // Test custom format
    const userWithCustomFormat = {
      name: 'Jane Doe',
      email: 'jane@example.com',
      zipCode: 'invalid-zip'
    };
    
    const customFormatResult = validationManager.validate('user', userWithCustomFormat);
    
    if (customFormatResult.valid) {
      throw new Error('Custom format validation passed for invalid data');
    }
    
    logger.info('‚úÖ Validation test passed');
  } else {
    logger.info('‚è© Validation not enabled, skipping test');
  }
  
  logger.info('‚úÖ Validation tests completed');
}

/**
 * Test internationalization
 */
async function testI18n(config) {
  logger.info('Testing internationalization...');
  
  if (config.i18n &amp;&amp; config.i18n.enabled) {
    const i18nManager = new I18nManager(config.i18n);
    await i18nManager.initialize();
    
    // Test translation
    const enTranslation = i18nManager.translate('welcome', { lng: 'en' });
    const esTranslation = i18nManager.translate('welcome', { lng: 'es' });
    
    if (!enTranslation || !esTranslation) {
      throw new Error('Translation failed');
    }
    
    logger.info('‚úÖ Internationalization test passed');
  } else {
    logger.info('‚è© Internationalization not enabled, skipping test');
  }
  
  logger.info('‚úÖ Internationalization tests completed');
}

/**
 * Test workflow engine
 */
async function testWorkflow(config, connections) {
  logger.info('Testing workflow engine...');
  
  if (config.workflow &amp;&amp; config.workflow.enabled) {
    const workflowEngine = new WorkflowEngine(config.workflow, connections);
    await workflowEngine.initialize();
    
    // Define a simple workflow
    const workflow = {
      id: 'test-workflow',
      name: 'Test Workflow',
      initialState: 'draft',
      states: {
        draft: {
          transitions: {
            submit: {
              target: 'review',
              conditions: []
            }
          }
        },
        review: {
          transitions: {
            approve: {
              target: 'approved',
              conditions: []
            },
            reject: {
              target: 'draft',
              conditions: []
            }
          }
        },
        approved: {
          final: true
        }
      }
    };
    
    // Register workflow
    await workflowEngine.registerWorkflow(workflow);
    
    // Create workflow instance
    const instance = await workflowEngine.createInstance('test-workflow', { documentId: 'test-123' });
    
    // Execute transitions
    await workflowEngine.transition(instance.id, 'submit');
    const updatedInstance = await workflowEngine.getInstance(instance.id);
    
    if (updatedInstance.currentState !== 'review') {
      throw new Error(`Workflow transition failed. Expected 'review', got '${updatedInstance.currentState}'`);
    }
    
    logger.info('‚úÖ Workflow engine test passed');
  } else {
    logger.info('‚è© Workflow engine not enabled, skipping test');
  }
  
  logger.info('‚úÖ Workflow engine tests completed');
}

/**
 * Test audit system
 */
async function testAudit(config, connections) {
  logger.info('Testing audit system...');
  
  if (config.audit &amp;&amp; config.audit.enabled) {
    const auditManager = new AuditManager(config.audit, connections);
    await auditManager.initialize();
    
    // Create a test audit entry
    await auditManager.logAction({
      userId: 'test-user',
      action: 'TEST',
      resource: 'system',
      resourceId: 'test-123',
      details: { test: true }
    });
    
    // Retrieve audit logs
    const logs = await auditManager.getAuditLogs({
      userId: 'test-user',
      action: 'TEST',
      limit: 1
    });
    
    if (logs.length === 0) {
      throw new Error('Audit log not found');
    }
    
    logger.info('‚úÖ Audit system test passed');
  } else {
    logger.info('‚è© Audit system not enabled, skipping test');
  }
  
  logger.info('‚úÖ Audit system tests completed');
}

/**
 * Test edge computing
 */
async function testEdgeComputing(config) {
  logger.info('Testing edge computing...');
  
  if (config.edge &amp;&amp; config.edge.enabled) {
    const edgeManager = new EdgeComputingManager(config.edge);
    await edgeManager.initialize();
    
    // Create a test function
    const testFunction = `
      module.exports = async function(input) {
        return { result: input.value * 2 };
      };
    `;
    
    // Register the function
    await edgeManager.registerFunction('test-function', testFunction);
    
    // Execute the function
    const result = await edgeManager.executeFunction('test-function', { value: 21 });
    
    if (!result || result.result !== 42) {
      throw new Error(`Edge function execution failed. Expected 42, got ${result?.result}`);
    }
    
    logger.info('‚úÖ Edge computing test passed');
  } else {
    logger.info('‚è© Edge computing not enabled, skipping test');
  }
  
  logger.info('‚úÖ Edge computing tests completed');
}

/**
 * Test cache system
 */
async function testCache(redisClient, config) {
  logger.info('Testing cache system...');
  
  if (redisClient &amp;&amp; config.cache) {
    const cacheManager = new CacheManager(redisClient, config.cache);
    
    // Set a value
    await cacheManager.set('test-key', { value: 'test-value' });
    
    // Get the value
    const value = await cacheManager.get('test-key');
    
    if (!value || value.value !== 'test-value') {
      throw new Error('Cache get/set failed');
    }
    
    // Delete the value
    await cacheManager.delete('test-key');
    
    // Verify it's gone
    const deletedValue = await cacheManager.get('test-key');
    
    if (deletedValue !== null) {
      throw new Error('Cache delete failed');
    }
    
    logger.info('‚úÖ Cache system test passed');
  } else {
    logger.info('‚è© Cache system not available, skipping test');
  }
  
  logger.info('‚úÖ Cache system tests completed');
}

/**
 * Close database connections
 */
async function closeDatabaseConnections(connections) {
  try {
    for (const [name, connection] of Object.entries(connections)) {
      if (connection &amp;&amp; typeof connection.close === 'function') {
        await connection.close();
        logger.info(`Closed ${name} connection`);
      } else if (connection &amp;&amp; typeof connection.quit === 'function') {
        await connection.quit();
        logger.info(`Closed ${name} connection`);
      }
    }
  } catch (error) {
    logger.error('‚ùå Failed to close database connections:', error);
  }
}

// Run tests
runTests(); 
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
