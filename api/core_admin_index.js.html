<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>core/admin/index.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AIServiceManager.html">AIServiceManager</a><ul class='methods'><li data-type='method'><a href="AIServiceManager.html#classifyText">classifyText</a></li><li data-type='method'><a href="AIServiceManager.html#generateEmbeddings">generateEmbeddings</a></li><li data-type='method'><a href="AIServiceManager.html#generateText">generateText</a></li><li data-type='method'><a href="AIServiceManager.html#getService">getService</a></li><li data-type='method'><a href="AIServiceManager.html#initialize">initialize</a></li><li data-type='method'><a href="AIServiceManager.html#initializeService">initializeService</a></li><li data-type='method'><a href="AIServiceManager.html#processImage">processImage</a></li></ul></li><li><a href="AdminInterfaceGenerator.html">AdminInterfaceGenerator</a><ul class='methods'><li data-type='method'><a href="AdminInterfaceGenerator.html#generateRoutes">generateRoutes</a></li><li data-type='method'><a href="AdminInterfaceGenerator.html#initialize">initialize</a></li><li data-type='method'><a href="AdminInterfaceGenerator.html#loadModels">loadModels</a></li><li data-type='method'><a href="AdminInterfaceGenerator.html#serveAdminUI">serveAdminUI</a></li><li data-type='method'><a href="AdminInterfaceGenerator.html#setupAuthentication">setupAuthentication</a></li></ul></li><li><a href="AuditManager.html">AuditManager</a><ul class='methods'><li data-type='method'><a href="AuditManager.html#createAuditContext">createAuditContext</a></li><li data-type='method'><a href="AuditManager.html#createAuditMiddleware">createAuditMiddleware</a></li><li data-type='method'><a href="AuditManager.html#createAuditTables">createAuditTables</a></li><li data-type='method'><a href="AuditManager.html#executeRightToBeForgotten">executeRightToBeForgotten</a></li><li data-type='method'><a href="AuditManager.html#generateGDPRExport">generateGDPRExport</a></li><li data-type='method'><a href="AuditManager.html#getAccessLogsForEntity">getAccessLogsForEntity</a></li><li data-type='method'><a href="AuditManager.html#getAuditLogsForEntity">getAuditLogsForEntity</a></li><li data-type='method'><a href="AuditManager.html#initialize">initialize</a></li><li data-type='method'><a href="AuditManager.html#logAccess">logAccess</a></li><li data-type='method'><a href="AuditManager.html#logChanges">logChanges</a></li><li data-type='method'><a href="AuditManager.html#sanitizeRequestBody">sanitizeRequestBody</a></li><li data-type='method'><a href="AuditManager.html#shouldAuditRequest">shouldAuditRequest</a></li></ul></li><li><a href="CacheManager.html">CacheManager</a><ul class='methods'><li data-type='method'><a href="CacheManager.html#clearNamespace">clearNamespace</a></li><li data-type='method'><a href="CacheManager.html#createMiddleware">createMiddleware</a></li><li data-type='method'><a href="CacheManager.html#delete">delete</a></li><li data-type='method'><a href="CacheManager.html#generateKey">generateKey</a></li><li data-type='method'><a href="CacheManager.html#get">get</a></li><li data-type='method'><a href="CacheManager.html#getOrSet">getOrSet</a></li><li data-type='method'><a href="CacheManager.html#set">set</a></li></ul></li><li><a href="EdgeComputingManager.html">EdgeComputingManager</a><ul class='methods'><li data-type='method'><a href="EdgeComputingManager.html#applyChangesFromEdge">applyChangesFromEdge</a></li><li data-type='method'><a href="EdgeComputingManager.html#applyCreateChange">applyCreateChange</a></li><li data-type='method'><a href="EdgeComputingManager.html#applyDeleteChange">applyDeleteChange</a></li><li data-type='method'><a href="EdgeComputingManager.html#applyUpdateChange">applyUpdateChange</a></li><li data-type='method'><a href="EdgeComputingManager.html#deployFunctionToEdge">deployFunctionToEdge</a></li><li data-type='method'><a href="EdgeComputingManager.html#executeFunctionOnEdge">executeFunctionOnEdge</a></li><li data-type='method'><a href="EdgeComputingManager.html#fetchPendingChanges">fetchPendingChanges</a></li><li data-type='method'><a href="EdgeComputingManager.html#getAllEdgeNodesStatus">getAllEdgeNodesStatus</a></li><li data-type='method'><a href="EdgeComputingManager.html#getEdgeNodeStatus">getEdgeNodeStatus</a></li><li data-type='method'><a href="EdgeComputingManager.html#getPendingChangesForNode">getPendingChangesForNode</a></li><li data-type='method'><a href="EdgeComputingManager.html#initialize">initialize</a></li><li data-type='method'><a href="EdgeComputingManager.html#loadEdgeNodes">loadEdgeNodes</a></li><li data-type='method'><a href="EdgeComputingManager.html#markChangeAsProcessed">markChangeAsProcessed</a></li><li data-type='method'><a href="EdgeComputingManager.html#pushChangesToEdge">pushChangesToEdge</a></li><li data-type='method'><a href="EdgeComputingManager.html#registerEdgeNode">registerEdgeNode</a></li><li data-type='method'><a href="EdgeComputingManager.html#signChange">signChange</a></li><li data-type='method'><a href="EdgeComputingManager.html#synchronizeAll">synchronizeAll</a></li><li data-type='method'><a href="EdgeComputingManager.html#synchronizeNode">synchronizeNode</a></li><li data-type='method'><a href="EdgeComputingManager.html#unregisterEdgeNode">unregisterEdgeNode</a></li><li data-type='method'><a href="EdgeComputingManager.html#validateChangeSignature">validateChangeSignature</a></li></ul></li><li><a href="EventManager.html">EventManager</a><ul class='methods'><li data-type='method'><a href="EventManager.html#getEvents">getEvents</a></li><li data-type='method'><a href="EventManager.html#initialize">initialize</a></li><li data-type='method'><a href="EventManager.html#initializeEventStore">initializeEventStore</a></li><li data-type='method'><a href="EventManager.html#initializeMessageQueue">initializeMessageQueue</a></li><li data-type='method'><a href="EventManager.html#publishEvent">publishEvent</a></li><li data-type='method'><a href="EventManager.html#replayEvents">replayEvents</a></li><li data-type='method'><a href="EventManager.html#setupMessageHandlers">setupMessageHandlers</a></li><li data-type='method'><a href="EventManager.html#subscribeToEvent">subscribeToEvent</a></li><li data-type='method'><a href="EventManager.html#unsubscribeFromEvent">unsubscribeFromEvent</a></li></ul></li><li><a href="I18nManager.html">I18nManager</a><ul class='methods'><li data-type='method'><a href="I18nManager.html#changeLanguage">changeLanguage</a></li><li data-type='method'><a href="I18nManager.html#createSampleLocales">createSampleLocales</a></li><li data-type='method'><a href="I18nManager.html#formatCurrency">formatCurrency</a></li><li data-type='method'><a href="I18nManager.html#formatDate">formatDate</a></li><li data-type='method'><a href="I18nManager.html#formatNumber">formatNumber</a></li><li data-type='method'><a href="I18nManager.html#getCurrentLanguage">getCurrentLanguage</a></li><li data-type='method'><a href="I18nManager.html#getMiddleware">getMiddleware</a></li><li data-type='method'><a href="I18nManager.html#getSupportedLanguages">getSupportedLanguages</a></li><li data-type='method'><a href="I18nManager.html#initialize">initialize</a></li><li data-type='method'><a href="I18nManager.html#translate">translate</a></li></ul></li><li><a href="MockDatabase.html">MockDatabase</a></li><li><a href="MockDatabaseClient.html">MockDatabaseClient</a></li><li><a href="MonitoringManager.html">MonitoringManager</a><ul class='methods'><li data-type='method'><a href="MonitoringManager.html#createMiddleware">createMiddleware</a></li><li data-type='method'><a href="MonitoringManager.html#getMetricsHandler">getMetricsHandler</a></li><li data-type='method'><a href="MonitoringManager.html#incrementCounter">incrementCounter</a></li><li data-type='method'><a href="MonitoringManager.html#initialize">initialize</a></li><li data-type='method'><a href="MonitoringManager.html#initializeDatadog">initializeDatadog</a></li><li data-type='method'><a href="MonitoringManager.html#initializeNewRelic">initializeNewRelic</a></li><li data-type='method'><a href="MonitoringManager.html#initializePrometheus">initializePrometheus</a></li><li data-type='method'><a href="MonitoringManager.html#initializeProvider">initializeProvider</a></li><li data-type='method'><a href="MonitoringManager.html#recordHistogram">recordHistogram</a></li><li data-type='method'><a href="MonitoringManager.html#recordMetric">recordMetric</a></li><li data-type='method'><a href="MonitoringManager.html#shutdown">shutdown</a></li><li data-type='method'><a href="MonitoringManager.html#startSystemMetricsCollection">startSystemMetricsCollection</a></li><li data-type='method'><a href="MonitoringManager.html#startTimer">startTimer</a></li></ul></li><li><a href="OpenAIService.html">OpenAIService</a><ul class='methods'><li data-type='method'><a href="OpenAIService.html#classifyText">classifyText</a></li><li data-type='method'><a href="OpenAIService.html#generateEmbeddings">generateEmbeddings</a></li><li data-type='method'><a href="OpenAIService.html#generateText">generateText</a></li><li data-type='method'><a href="OpenAIService.html#initialize">initialize</a></li><li data-type='method'><a href="OpenAIService.html#processImage">processImage</a></li></ul></li><li><a href="PluginManager.html">PluginManager</a><ul class='methods'><li data-type='method'><a href="PluginManager.html#createMiddleware">createMiddleware</a></li><li data-type='method'><a href="PluginManager.html#executeHooks">executeHooks</a></li><li data-type='method'><a href="PluginManager.html#loadPlugins">loadPlugins</a></li><li data-type='method'><a href="PluginManager.html#register">register</a></li></ul></li><li><a href="PostgresEventStore.html">PostgresEventStore</a><ul class='methods'><li data-type='method'><a href="PostgresEventStore.html#getEvents">getEvents</a></li><li data-type='method'><a href="PostgresEventStore.html#initialize">initialize</a></li><li data-type='method'><a href="PostgresEventStore.html#storeEvent">storeEvent</a></li></ul></li><li><a href="RedisQueue.html">RedisQueue</a><ul class='methods'><li data-type='method'><a href="RedisQueue.html#initialize">initialize</a></li><li data-type='method'><a href="RedisQueue.html#publish">publish</a></li><li data-type='method'><a href="RedisQueue.html#subscribe">subscribe</a></li><li data-type='method'><a href="RedisQueue.html#unsubscribe">unsubscribe</a></li></ul></li><li><a href="SecurityAuditManager.html">SecurityAuditManager</a><ul class='methods'><li data-type='method'><a href="SecurityAuditManager.html#createAuditTables">createAuditTables</a></li><li data-type='method'><a href="SecurityAuditManager.html#createMiddleware">createMiddleware</a></li><li data-type='method'><a href="SecurityAuditManager.html#getSecurityAuditLogs">getSecurityAuditLogs</a></li><li data-type='method'><a href="SecurityAuditManager.html#initialize">initialize</a></li><li data-type='method'><a href="SecurityAuditManager.html#logSecurityEvent">logSecurityEvent</a></li><li data-type='method'><a href="SecurityAuditManager.html#shutdown">shutdown</a></li></ul></li><li><a href="SecurityScanner.html">SecurityScanner</a><ul class='methods'><li data-type='method'><a href="SecurityScanner.html#countIssues">countIssues</a></li><li data-type='method'><a href="SecurityScanner.html#findSourceFiles">findSourceFiles</a></li><li data-type='method'><a href="SecurityScanner.html#generateRecommendations">generateRecommendations</a></li><li data-type='method'><a href="SecurityScanner.html#generateReport">generateReport</a></li><li data-type='method'><a href="SecurityScanner.html#getConfigFiles">getConfigFiles</a></li><li data-type='method'><a href="SecurityScanner.html#getJsFiles">getJsFiles</a></li><li data-type='method'><a href="SecurityScanner.html#getLineNumber">getLineNumber</a></li><li data-type='method'><a href="SecurityScanner.html#initialize">initialize</a></li><li data-type='method'><a href="SecurityScanner.html#runAllScans">runAllScans</a></li><li data-type='method'><a href="SecurityScanner.html#runScan">runScan</a></li><li data-type='method'><a href="SecurityScanner.html#saveReport">saveReport</a></li><li data-type='method'><a href="SecurityScanner.html#scanCode">scanCode</a></li><li data-type='method'><a href="SecurityScanner.html#scanCode">scanCode</a></li><li data-type='method'><a href="SecurityScanner.html#scanConfigurations">scanConfigurations</a></li><li data-type='method'><a href="SecurityScanner.html#scanDependencies">scanDependencies</a></li><li data-type='method'><a href="SecurityScanner.html#scanDependencies">scanDependencies</a></li><li data-type='method'><a href="SecurityScanner.html#scanEndpoints">scanEndpoints</a></li><li data-type='method'><a href="SecurityScanner.html#sendEmailNotification">sendEmailNotification</a></li><li data-type='method'><a href="SecurityScanner.html#sendNotifications">sendNotifications</a></li><li data-type='method'><a href="SecurityScanner.html#sendSlackNotification">sendSlackNotification</a></li><li data-type='method'><a href="SecurityScanner.html#shutdown">shutdown</a></li></ul></li><li></li><li><a href="ServerlessAdapter.html">ServerlessAdapter</a><ul class='methods'><li data-type='method'><a href="ServerlessAdapter.html#createAWSHandler">createAWSHandler</a></li><li data-type='method'><a href="ServerlessAdapter.html#createAzureHandler">createAzureHandler</a></li><li data-type='method'><a href="ServerlessAdapter.html#createGCPHandler">createGCPHandler</a></li><li data-type='method'><a href="ServerlessAdapter.html#initialize">initialize</a></li></ul></li><li><a href="TenantManager.html">TenantManager</a><ul class='methods'><li data-type='method'><a href="TenantManager.html#createTenant">createTenant</a></li><li data-type='method'><a href="TenantManager.html#deleteTenant">deleteTenant</a></li><li data-type='method'><a href="TenantManager.html#getTenant">getTenant</a></li><li data-type='method'><a href="TenantManager.html#getTenantByDomain">getTenantByDomain</a></li><li data-type='method'><a href="TenantManager.html#getTenantDatabaseName">getTenantDatabaseName</a></li><li data-type='method'><a href="TenantManager.html#getTenantSchemaName">getTenantSchemaName</a></li><li data-type='method'><a href="TenantManager.html#initialize">initialize</a></li><li data-type='method'><a href="TenantManager.html#loadTenants">loadTenants</a></li><li data-type='method'><a href="TenantManager.html#tenantMiddleware">tenantMiddleware</a></li><li data-type='method'><a href="TenantManager.html#updateTenant">updateTenant</a></li></ul></li><li><a href="ValidationManager.html">ValidationManager</a><ul class='methods'><li data-type='method'><a href="ValidationManager.html#addSchema">addSchema</a></li><li data-type='method'><a href="ValidationManager.html#createValidationMiddleware">createValidationMiddleware</a></li><li data-type='method'><a href="ValidationManager.html#getSchema">getSchema</a></li><li data-type='method'><a href="ValidationManager.html#getSchemaNames">getSchemaNames</a></li><li data-type='method'><a href="ValidationManager.html#validate">validate</a></li></ul></li><li><a href="WorkflowEngine.html">WorkflowEngine</a><ul class='methods'><li data-type='method'><a href="WorkflowEngine.html#cancelWorkflow">cancelWorkflow</a></li><li data-type='method'><a href="WorkflowEngine.html#completeWorkflow">completeWorkflow</a></li><li data-type='method'><a href="WorkflowEngine.html#evaluateCondition">evaluateCondition</a></li><li data-type='method'><a href="WorkflowEngine.html#executeActions">executeActions</a></li><li data-type='method'><a href="WorkflowEngine.html#executeStateActions">executeStateActions</a></li><li data-type='method'><a href="WorkflowEngine.html#executeTransition">executeTransition</a></li><li data-type='method'><a href="WorkflowEngine.html#getWorkflowInstance">getWorkflowInstance</a></li><li data-type='method'><a href="WorkflowEngine.html#getWorkflowInstancesForEntity">getWorkflowInstancesForEntity</a></li><li data-type='method'><a href="WorkflowEngine.html#handleWorkflowCancel">handleWorkflowCancel</a></li><li data-type='method'><a href="WorkflowEngine.html#handleWorkflowComplete">handleWorkflowComplete</a></li><li data-type='method'><a href="WorkflowEngine.html#handleWorkflowStart">handleWorkflowStart</a></li><li data-type='method'><a href="WorkflowEngine.html#handleWorkflowTransition">handleWorkflowTransition</a></li><li data-type='method'><a href="WorkflowEngine.html#initialize">initialize</a></li><li data-type='method'><a href="WorkflowEngine.html#loadWorkflows">loadWorkflows</a></li><li data-type='method'><a href="WorkflowEngine.html#mapDatabaseInstanceToObject">mapDatabaseInstanceToObject</a></li><li data-type='method'><a href="WorkflowEngine.html#saveWorkflowInstance">saveWorkflowInstance</a></li><li data-type='method'><a href="WorkflowEngine.html#setupEventListeners">setupEventListeners</a></li><li data-type='method'><a href="WorkflowEngine.html#startWorkflow">startWorkflow</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#$randomEmail">$randomEmail</a></li><li><a href="global.html#applyMiddleware">applyMiddleware</a></li><li><a href="global.html#calculatePercentile">calculatePercentile</a></li><li><a href="global.html#closeConnections">closeConnections</a></li><li><a href="global.html#closeDatabaseConnections">closeDatabaseConnections</a></li><li><a href="global.html#connectDatabases">connectDatabases</a></li><li><a href="global.html#connectMockDatabase">connectMockDatabase</a></li><li><a href="global.html#connectMongoDB">connectMongoDB</a></li><li><a href="global.html#connectPostgres">connectPostgres</a></li><li><a href="global.html#connectRedis">connectRedis</a></li><li><a href="global.html#createMigration">createMigration</a></li><li><a href="global.html#createMigrationsTable">createMigrationsTable</a></li><li><a href="global.html#deepMerge">deepMerge</a></li><li><a href="global.html#generateApiClient">generateApiClient</a></li><li><a href="global.html#generateGraphQLComposables">generateGraphQLComposables</a></li><li><a href="global.html#generateGraphQLHooks">generateGraphQLHooks</a></li><li><a href="global.html#generateIndexFile">generateIndexFile</a></li><li><a href="global.html#generateReactSDK">generateReactSDK</a></li><li><a href="global.html#generateRestComposables">generateRestComposables</a></li><li><a href="global.html#generateRestHooks">generateRestHooks</a></li><li><a href="global.html#generateVueSDK">generateVueSDK</a></li><li><a href="global.html#generateWebSocketComposables">generateWebSocketComposables</a></li><li><a href="global.html#generateWebSocketHooks">generateWebSocketHooks</a></li><li><a href="global.html#getAppliedMigrations">getAppliedMigrations</a></li><li><a href="global.html#getDatabaseClient">getDatabaseClient</a></li><li><a href="global.html#hasRoles">hasRoles</a></li><li><a href="global.html#isAuthenticated">isAuthenticated</a></li><li><a href="global.html#isObject">isObject</a></li><li><a href="global.html#loadConfig">loadConfig</a></li><li><a href="global.html#logger">logger</a></li><li><a href="global.html#mergeResolvers">mergeResolvers</a></li><li><a href="global.html#parseConfigValue">parseConfigValue</a></li><li><a href="global.html#recordMigration">recordMigration</a></li><li><a href="global.html#registerGRPCService">registerGRPCService</a></li><li><a href="global.html#registerModelEventHandlers">registerModelEventHandlers</a></li><li><a href="global.html#registerModelRoutes">registerModelRoutes</a></li><li><a href="global.html#runConcurrentTests">runConcurrentTests</a></li><li><a href="global.html#runMigrations">runMigrations</a></li><li><a href="global.html#runPerformanceTests">runPerformanceTests</a></li><li><a href="global.html#runTests">runTests</a></li><li><a href="global.html#selectRandomProduct">selectRandomProduct</a></li><li><a href="global.html#setNestedValue">setNestedValue</a></li><li><a href="global.html#setupApiKeyStrategy">setupApiKeyStrategy</a></li><li><a href="global.html#setupAuthRoutes">setupAuthRoutes</a></li><li><a href="global.html#setupAuthentication">setupAuthentication</a></li><li><a href="global.html#setupGRPC">setupGRPC</a></li><li><a href="global.html#setupGraphQLSchema">setupGraphQLSchema</a></li><li><a href="global.html#setupHealthChecks">setupHealthChecks</a></li><li><a href="global.html#setupJwtStrategy">setupJwtStrategy</a></li><li><a href="global.html#setupMonitoring">setupMonitoring</a></li><li><a href="global.html#setupMySQL">setupMySQL</a></li><li><a href="global.html#setupOAuth2Strategies">setupOAuth2Strategies</a></li><li><a href="global.html#setupRESTApi">setupRESTApi</a></li><li><a href="global.html#setupRateLimiting">setupRateLimiting</a></li><li><a href="global.html#setupWebSockets">setupWebSockets</a></li><li><a href="global.html#simpleTest">simpleTest</a></li><li><a href="global.html#tenantContextMiddleware">tenantContextMiddleware</a></li><li><a href="global.html#testAI">testAI</a></li><li><a href="global.html#testAIServices">testAIServices</a></li><li><a href="global.html#testAsyncFunction">testAsyncFunction</a></li><li><a href="global.html#testAudit">testAudit</a></li><li><a href="global.html#testCache">testCache</a></li><li><a href="global.html#testEdgeComputing">testEdgeComputing</a></li><li><a href="global.html#testEndpoint">testEndpoint</a></li><li><a href="global.html#testEventSystem">testEventSystem</a></li><li><a href="global.html#testEvents">testEvents</a></li><li><a href="global.html#testFeatures">testFeatures</a></li><li><a href="global.html#testI18n">testI18n</a></li><li><a href="global.html#testMultiTenant">testMultiTenant</a></li><li><a href="global.html#testSecurity">testSecurity</a></li><li><a href="global.html#testValidation">testValidation</a></li><li><a href="global.html#testWorkflow">testWorkflow</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">core/admin/index.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const express = require('express');
const path = require('path');
const fs = require('fs');
const logger = require('../utils/logger');

/**
 * Admin Interface Generator
 */
class AdminInterfaceGenerator {
  constructor(config = {}) {
    this.config = config;
    this.router = express.Router();
    this.models = new Map();
  }
  
  /**
   * Initialize admin interface
   */
  async initialize(app) {
    try {
      // Setup authentication for admin routes
      this.setupAuthentication();
      
      // Load models
      await this.loadModels();
      
      // Generate admin routes
      this.generateRoutes();
      
      // Serve admin UI
      this.serveAdminUI();
      
      // Mount admin router
      const basePath = this.config.basePath || '/admin';
      app.use(basePath, this.router);
      
      logger.info(`Admin interface initialized at ${basePath}`);
      return true;
    } catch (error) {
      logger.error('Failed to initialize admin interface:', error);
      throw error;
    }
  }
  
  /**
   * Setup authentication for admin routes
   */
  setupAuthentication() {
    // Add authentication middleware
    this.router.use((req, res, next) => {
      // Check if user is authenticated and has admin role
      if (!req.user) {
        return res.status(401).json({ error: 'Authentication required' });
      }
      
      if (!req.user.roles || !req.user.roles.includes('admin')) {
        return res.status(403).json({ error: 'Admin role required' });
      }
      
      next();
    });
  }
  
  /**
   * Load models for admin interface
   */
  async loadModels() {
    try {
      const modelsDir = path.join(process.cwd(), 'src', 'models');
      
      if (!fs.existsSync(modelsDir)) {
        logger.warn('Models directory not found');
        return;
      }
      
      const modelFiles = fs.readdirSync(modelsDir).filter(file => file.endsWith('.js'));
      
      for (const file of modelFiles) {
        try {
          const model = require(path.join(modelsDir, file));
          
          // Skip models that don't have admin configuration
          if (!model.admin) {
            continue;
          }
          
          // Add model to admin interface
          this.models.set(model.name, {
            ...model,
            fields: model.admin.fields || Object.keys(model.schema || {})
          });
          
          logger.debug(`Added model to admin interface: ${model.name}`);
        } catch (error) {
          logger.error(`Failed to load model from file ${file}:`, error);
        }
      }
      
      logger.info(`Loaded ${this.models.size} models for admin interface`);
    } catch (error) {
      logger.error('Failed to load models for admin interface:', error);
      throw error;
    }
  }
  
  /**
   * Generate admin routes for models
   */
  generateRoutes() {
    // API routes for models
    const apiRouter = express.Router();
    
    // Add routes for each model
    for (const [modelName, model] of this.models) {
      const modelRouter = express.Router();
      
      // List items
      modelRouter.get('/', async (req, res) => {
        try {
          const { page = 1, limit = 10, sort, filter } = req.query;
          
          // Get database client
          const dbClient = req.app.locals.connections[model.database || 'postgres'];
          
          if (!dbClient) {
            return res.status(500).json({ error: `Database client not found: ${model.database}` });
          }
          
          // Build query
          let query = {};
          let sortOptions = {};
          
          // Apply filters
          if (filter) {
            try {
              query = JSON.parse(filter);
            } catch (error) {
              return res.status(400).json({ error: 'Invalid filter format' });
            }
          }
          
          // Apply sorting
          if (sort) {
            try {
              sortOptions = JSON.parse(sort);
            } catch (error) {
              return res.status(400).json({ error: 'Invalid sort format' });
            }
          }
          
          // Apply tenant filter if multi-tenant
          if (req.tenant &amp;&amp; model.multiTenant) {
            query.tenantId = req.tenant.id;
          }
          
          // Execute query based on database type
          let items = [];
          let total = 0;
          
          if (model.database === 'mongodb') {
            // MongoDB query
            const collection = dbClient.collection(model.collection);
            
            // Get total count
            total = await collection.countDocuments(query);
            
            // Get items with pagination
            items = await collection.find(query)
              .sort(sortOptions)
              .skip((page - 1) * limit)
              .limit(parseInt(limit))
              .toArray();
          } else {
            // SQL query (simplified)
            const offset = (page - 1) * limit;
            const result = await dbClient.query(
              `SELECT * FROM ${model.table} LIMIT $1 OFFSET $2`,
              [limit, offset]
            );
            
            items = result.rows || result;
            
            // Get total count
            const countResult = await dbClient.query(`SELECT COUNT(*) FROM ${model.table}`);
            total = parseInt(countResult.rows[0].count);
          }
          
          res.json({
            items,
            pagination: {
              page: parseInt(page),
              limit: parseInt(limit),
              total,
              pages: Math.ceil(total / limit)
            }
          });
        } catch (error) {
          logger.error(`Error in admin list route for ${modelName}:`, error);
          res.status(500).json({ error: error.message });
        }
      });
      
      // Get single item
      modelRouter.get('/:id', async (req, res) => {
        try {
          const { id } = req.params;
          
          // Get database client
          const dbClient = req.app.locals.connections[model.database || 'postgres'];
          
          if (!dbClient) {
            return res.status(500).json({ error: `Database client not found: ${model.database}` });
          }
          
          // Execute query based on database type
          let item = null;
          
          if (model.database === 'mongodb') {
            // MongoDB query
            const collection = dbClient.collection(model.collection);
            item = await collection.findOne({ _id: id });
          } else {
            // SQL query
            const result = await dbClient.query(
              `SELECT * FROM ${model.table} WHERE id = $1`,
              [id]
            );
            
            item = result.rows[0] || null;
          }
          
          if (!item) {
            return res.status(404).json({ error: 'Item not found' });
          }
          
          res.json(item);
        } catch (error) {
          logger.error(`Error in admin get route for ${modelName}:`, error);
          res.status(500).json({ error: error.message });
        }
      });
      
      // Create item
      modelRouter.post('/', async (req, res) => {
        try {
          const data = req.body;
          
          // Get database client
          const dbClient = req.app.locals.connections[model.database || 'postgres'];
          
          if (!dbClient) {
            return res.status(500).json({ error: `Database client not found: ${model.database}` });
          }
          
          // Add tenant ID if multi-tenant
          if (req.tenant &amp;&amp; model.multiTenant) {
            data.tenantId = req.tenant.id;
          }
          
          // Execute query based on database type
          let item = null;
          
          if (model.database === 'mongodb') {
            // MongoDB query
            const collection = dbClient.collection(model.collection);
            const result = await collection.insertOne(data);
            item = { ...data, _id: result.insertedId };
          } else {
            // SQL query (simplified)
            const fields = Object.keys(data);
            const values = Object.values(data);
            const placeholders = fields.map((_, i) => `$${i + 1}`).join(', ');
            
            const result = await dbClient.query(
              `INSERT INTO ${model.table} (${fields.join(', ')}) VALUES (${placeholders}) RETURNING *`,
              values
            );
            
            item = result.rows[0];
          }
          
          res.status(201).json(item);
        } catch (error) {
          logger.error(`Error in admin create route for ${modelName}:`, error);
          res.status(500).json({ error: error.message });
        }
      });
      
      // Update item
      modelRouter.put('/:id', async (req, res) => {
        try {
          const { id } = req.params;
          const data = req.body;
          
          // Get database client
          const dbClient = req.app.locals.connections[model.database || 'postgres'];
          
          if (!dbClient) {
            return res.status(500).json({ error: `Database client not found: ${model.database}` });
          }
          
          // Execute query based on database type
          let item = null;
          
          if (model.database === 'mongodb') {
            // MongoDB query
            const collection = dbClient.collection(model.collection);
            await collection.updateOne({ _id: id }, { $set: data });
            item = await collection.findOne({ _id: id });
          } else {
            // SQL query (simplified)
            const fields = Object.keys(data);
            const values = Object.values(data);
            const setClause = fields.map((field, i) => `${field} = $${i + 1}`).join(', ');
            
            const result = await dbClient.query(
              `UPDATE ${model.table} SET ${setClause} WHERE id = $${fields.length + 1} RETURNING *`,
              [...values, id]
            );
            
            item = result.rows[0];
          }
          
          if (!item) {
            return res.status(404).json({ error: 'Item not found' });
          }
          
          res.json(item);
        } catch (error) {
          logger.error(`Error in admin update route for ${modelName}:`, error);
          res.status(500).json({ error: error.message });
        }
      });
      
      // Delete item
      modelRouter.delete('/:id', async (req, res) => {
        try {
          const { id } = req.params;
          
          // Get database client
          const dbClient = req.app.locals.connections[model.database || 'postgres'];
          
          if (!dbClient) {
            return res.status(500).json({ error: `Database client not found: ${model.database}` });
          }
          
          // Execute query based on database type
          let success = false;
          
          if (model.database === 'mongodb') {
            // MongoDB query
            const collection = dbClient.collection(model.collection);
            const result = await collection.deleteOne({ _id: id });
            success = result.deletedCount > 0;
          } else {
            // SQL query
            const result = await dbClient.query(
              `DELETE FROM ${model.table} WHERE id = $1`,
              [id]
            );
            
            success = result.rowCount > 0;
          }
          
          if (!success) {
            return res.status(404).json({ error: 'Item not found' });
          }
          
          res.status(204).end();
        } catch (error) {
          logger.error(`Error in admin delete route for ${modelName}:`, error);
          res.status(500).json({ error: error.message });
        }
      });
      
      // Mount model router
      apiRouter.use(`/${modelName.toLowerCase()}`, modelRouter);
    }
    
    // Mount API router
    this.router.use('/api', apiRouter);
    
    // Add metadata route
    this.router.get('/meta', (req, res) => {
      const models = Array.from(this.models.entries()).map(([name, model]) => ({
        name,
        label: model.admin.label || name,
        fields: model.fields.map(field => {
          const fieldConfig = model.admin.fieldConfig?.[field] || {};
          return {
            name: field,
            label: fieldConfig.label || field,
            type: fieldConfig.type || 'text',
            required: fieldConfig.required || false,
            options: fieldConfig.options || null
          };
        }),
        listFields: model.admin.listFields || model.fields,
        searchFields: model.admin.searchFields || [],
        filters: model.admin.filters || []
      }));
      
      res.json({ models });
    });
  }
  
  /**
   * Serve admin UI
   */
  serveAdminUI() {
    // Serve static files
    const adminUIPath = path.join(process.cwd(), 'admin-ui', 'build');
    
    if (fs.existsSync(adminUIPath)) {
      this.router.use(express.static(adminUIPath));
      
      // Serve index.html for all routes (SPA support)
      this.router.get('*', (req, res) => {
        res.sendFile(path.join(adminUIPath, 'index.html'));
      });
    } else {
      logger.warn('Admin UI build directory not found. Admin UI will not be served.');
      
      // Serve a placeholder page
      this.router.get('/', (req, res) => {
        res.send(`
          &lt;html>
            &lt;head>
              &lt;title>Admin Interface&lt;/title>
              &lt;style>
                body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
                h1 { color: #333; }
                .message { background: #f8f9fa; padding: 20px; border-radius: 5px; }
              &lt;/style>
            &lt;/head>
            &lt;body>
              &lt;h1>Admin Interface&lt;/h1>
              &lt;div class="message">
                &lt;p>The admin UI is not built yet. Please build the admin UI first.&lt;/p>
                &lt;p>API endpoints are available at &lt;a href="/admin/api">/admin/api&lt;/a>&lt;/p>
                &lt;p>Metadata is available at &lt;a href="/admin/meta">/admin/meta&lt;/a>&lt;/p>
              &lt;/div>
            &lt;/body>
          &lt;/html>
        `);
      });
    }
  }
}

module.exports = AdminInterfaceGenerator; </code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
